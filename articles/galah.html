<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>galah • galah</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="galah">
<meta property="og:description" content="galah">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">galah</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/galah.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AtlasOfLivingAustralia/galah/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>galah</h1>
                        <h4 class="author">Matilda Stevenson</h4>
            
            <h4 class="date">2021-02-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AtlasOfLivingAustralia/galah/blob/master/vignettes/galah.Rmd"><code>vignettes/galah.Rmd</code></a></small>
      <div class="hidden name"><code>galah.Rmd</code></div>

    </div>

    
    
<div id="galah" class="section level1">
<h1 class="hasAnchor">
<a href="#galah" class="anchor"></a>galah</h1>
<div id="installing-galah" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-galah" class="anchor"></a>Installing galah</h2>
<p>Development version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"AtlasOfLivingAustralia/galah"</span><span class="op">)</span></code></pre></div>
<p>On Linux you will first need to ensure that <code>libcurl</code> and <code>v8</code> (version &lt;= 3.15) are installed on your system — e.g. on Ubuntu/Debian, open a terminal and do:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">sudo</span> apt-get install libcurl4-openssl-dev libv8-3.14-dev</a></code></pre></div>
</div>
<div id="using-galah" class="section level2">
<h2 class="hasAnchor">
<a href="#using-galah" class="anchor"></a>Using galah</h2>
<p>The galah package must be loaded for each new R session:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AtlasOfLivingAustralia/galah">galah</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="example-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#example-usage" class="anchor"></a>Example usage</h2>
<p>First, check that we have some additional packages that we’ll use in the examples, and install them if necessary.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">to_install</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"ozmaps"</span>, <span class="st">"sf"</span><span class="op">)</span>
<span class="va">to_install</span> <span class="op">&lt;-</span> <span class="va">to_install</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">to_install</span>, <span class="va">requireNamespace</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">to_install</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">to_install</span>, repos<span class="op">=</span><span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span>

<span class="co">## In these examples we use the `dplyr` package to help with data manipulation.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mdsumner/ozmaps">ozmaps</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="taxon-information" class="section level2">
<h2 class="hasAnchor">
<a href="#taxon-information" class="anchor"></a>Taxon information</h2>
<p><code>ala_taxa</code> provides information on one or more taxa. It can take either a scientific name (default), or a unqiue taxon identifier. The output of <code><a href="../reference/ala_taxa.html">ala_taxa()</a></code> can be used as the <code>taxa</code> parameter in <code><a href="../reference/ala_counts.html">ala_counts()</a></code> and <code><a href="../reference/ala_occurrences.html">ala_occurrences()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A single taxa</span>
<span class="fu"><a href="../reference/ala_taxa.html">ala_taxa</a></span><span class="op">(</span><span class="st">"Dasyurus viverrinus"</span><span class="op">)</span></code></pre></div>
<pre><code>##           search_term     scientific_name scientific_name_authorship
## 1 Dasyurus viverrinus Dasyurus viverrinus               (Shaw, 1800)
##                                                              taxon_concept_id    rank match_type  kingdom   phylum
## 1 urn:lsid:biodiversity.org.au:afd.taxon:52149285-a12a-4085-a285-b41af5ba3ce3 species exactMatch Animalia Chordata
##      class          order     family    genus             species  issues
## 1 Mammalia Dasyuromorphia Dasyuridae Dasyurus Dasyurus viverrinus noIssue</code></pre>
<p><code><a href="../reference/ala_taxa.html">ala_taxa()</a></code> can return record counts for taxa with <code>include_counts = TRUE</code>, and the child concepts for taxa with <code>return_children = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">banksia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_taxa.html">ala_taxa</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">"Banksia"</span><span class="op">)</span>, return_children <span class="op">=</span> <span class="cn">TRUE</span>, include_counts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Select only the species-level taxa, sort by count, and display the top 5</span>
<span class="va">top5_banksia</span> <span class="op">&lt;-</span> <span class="va">banksia</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"species"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">scientific_name</span>, <span class="va">taxon_concept_id</span>, <span class="va">count</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="va">top5_banksia</span></code></pre></div>
<pre><code>##         scientific_name                                   taxon_concept_id count
## 1:    Banksia marginata   https://id.biodiversity.org.au/node/apni/2912814 27418
## 2:    Banksia spinulosa   https://id.biodiversity.org.au/node/apni/7931274 13644
## 3:      Banksia serrata https://id.biodiversity.org.au/taxon/apni/51293610 11258
## 4: Banksia integrifolia   https://id.biodiversity.org.au/node/apni/2892579 10373
## 5:   Banksia ericifolia https://id.biodiversity.org.au/taxon/apni/51299883  7461</code></pre>
<p>Use <code><a href="../reference/ala_taxa.html">ala_taxa()</a></code> to lookup a taxon id</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">id</span> <span class="op">&lt;-</span> <span class="st">"urn:lsid:biodiversity.org.au:afd.taxon:d315deea-822c-4f2c-b439-da33d6af5fd6"</span>
<span class="fu"><a href="../reference/ala_taxa.html">ala_taxa</a></span><span class="op">(</span>term <span class="op">=</span> <span class="va">id</span>, term_type <span class="op">=</span> <span class="st">"identifier"</span><span class="op">)</span></code></pre></div>
<pre><code>##   scientific_name scientific_name_authorship
## 1 Elusor macrurus        Cann &amp; Legler, 1994
##                                                              taxon_concept_id    rank   match_type  kingdom   phylum
## 1 urn:lsid:biodiversity.org.au:afd.taxon:d315deea-822c-4f2c-b439-da33d6af5fd6 species taxonIdMatch Animalia Chordata
##      class      order   family  genus         species  issues
## 1 Reptilia Testudines Chelidae Elusor Elusor macrurus noIssue</code></pre>
</div>
<div id="occurrence-data" class="section level2">
<h2 class="hasAnchor">
<a href="#occurrence-data" class="anchor"></a>Occurrence data</h2>
<p>Download occurrence data for a taxon. To download occurrence data you will need to specify your email in <code><a href="../reference/ala_config.html">ala_config()</a></code>. This email must be associated with an active ALA account. To save your email for future sessions, set <code>preserve = TRUE</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ala_config.html">ala_config</a></span><span class="op">(</span>email <span class="op">=</span> <span class="va">your_email_here</span>, preserve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Download occurrence records for 5 Banksia species</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_occurrences.html">ala_occurrences</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="va">top5_banksia</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">occ</span><span class="op">)</span></code></pre></div>
<pre><code>##   X decimalLatitude decimalLongitude  eventDate                        scientificName
## 1 1       -37.68690         149.0141 2011-01-10                     Banksia marginata
## 2 2       -34.02774         150.9902 2011-01-01      Banksia spinulosa var. spinulosa
## 3 3       -30.86286         152.2726 2011-01-18                     Banksia marginata
## 4 4       -29.03396         153.4487 2019-01-20                       Banksia serrata
## 5 5       -31.40016         151.8790 2016-01-09 Banksia integrifolia subsp. monticola
## 6 6       -43.37276         146.1351 2000-01-31                     Banksia marginata
##                                       taxonConceptID                             recordID
## 1   https://id.biodiversity.org.au/node/apni/2912814 fff78000-ad2e-441e-8280-411eaced8223
## 2   https://id.biodiversity.org.au/node/apni/2913042 ffccf591-918c-42ad-81d5-e4433e2303b3
## 3   https://id.biodiversity.org.au/node/apni/2912814 ffc33869-0258-415e-9994-211216aac321
## 4 https://id.biodiversity.org.au/taxon/apni/51293610 ffacc5bd-d0d1-422e-8d29-9878a783b891
## 5   https://id.biodiversity.org.au/node/apni/2918640 ff974b09-62ec-4dda-8736-e1bff9f4edbc
## 6   https://id.biodiversity.org.au/node/apni/2912814 ff93c77e-223a-48fb-8333-c49380859fe6
##                       data_resource   country
## 1      Victorian Biodiversity Atlas Australia
## 2         OEH Atlas of NSW Wildlife Australia
## 3         OEH Atlas of NSW Wildlife Australia
## 4 ALA species sightings and OzAtlas Australia
## 5         OEH Atlas of NSW Wildlife Australia
## 6    Tasmanian Natural Values Atlas Australia</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># build filters and columns</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_columns.html">select_columns</a></span><span class="op">(</span><span class="st">"country"</span>, group <span class="op">=</span> <span class="st">"basic"</span><span class="op">)</span>
<span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_filters.html">select_filters</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2020</span><span class="op">)</span><span class="op">)</span>
<span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_occurrences.html">ala_occurrences</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="va">top5_banksia</span>,
                       columns <span class="op">=</span> <span class="va">cols</span>, filters <span class="op">=</span> <span class="va">filters</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered_occ</span> <span class="op">&lt;-</span> <span class="va">occ</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"Australia"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">filtered_occ</span><span class="op">)</span></code></pre></div>
<pre><code>##   X decimalLatitude decimalLongitude  eventDate                        scientificName
## 1 1       -37.68690         149.0141 2011-01-10                     Banksia marginata
## 2 2       -34.02774         150.9902 2011-01-01      Banksia spinulosa var. spinulosa
## 3 3       -30.86286         152.2726 2011-01-18                     Banksia marginata
## 4 4       -29.03396         153.4487 2019-01-20                       Banksia serrata
## 5 5       -31.40016         151.8790 2016-01-09 Banksia integrifolia subsp. monticola
## 6 6       -43.37276         146.1351 2000-01-31                     Banksia marginata
##                                       taxonConceptID                             recordID
## 1   https://id.biodiversity.org.au/node/apni/2912814 fff78000-ad2e-441e-8280-411eaced8223
## 2   https://id.biodiversity.org.au/node/apni/2913042 ffccf591-918c-42ad-81d5-e4433e2303b3
## 3   https://id.biodiversity.org.au/node/apni/2912814 ffc33869-0258-415e-9994-211216aac321
## 4 https://id.biodiversity.org.au/taxon/apni/51293610 ffacc5bd-d0d1-422e-8d29-9878a783b891
## 5   https://id.biodiversity.org.au/node/apni/2918640 ff974b09-62ec-4dda-8736-e1bff9f4edbc
## 6   https://id.biodiversity.org.au/node/apni/2912814 ff93c77e-223a-48fb-8333-c49380859fe6
##                       data_resource   country
## 1      Victorian Biodiversity Atlas Australia
## 2         OEH Atlas of NSW Wildlife Australia
## 3         OEH Atlas of NSW Wildlife Australia
## 4 ALA species sightings and OzAtlas Australia
## 5         OEH Atlas of NSW Wildlife Australia
## 6    Tasmanian Natural Values Atlas Australia</code></pre>
<p>Plot occurrence data using <code>ggplot</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ozmap_country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="va">filtered_occ</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">decimalLongitude</span>, y <span class="op">=</span> <span class="va">decimalLatitude</span>,
                                         colour <span class="op">=</span> <span class="va">scientificName</span><span class="op">)</span>,size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span></code></pre></div>
</div>
<div id="customising-searches" class="section level2">
<h2 class="hasAnchor">
<a href="#customising-searches" class="anchor"></a>Customising searches</h2>
<p>Occurrence searches can be narrowed down by area, a variety of filters, and data quality tests.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find all reptiles within a shapefile</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_taxa.html">ala_taxa</a></span><span class="op">(</span><span class="st">"Ornithorhynchus anatinus"</span><span class="op">)</span>
<span class="va">simple_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_cast.html">st_cast</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">'act_rect.shp'</span><span class="op">)</span>, <span class="st">"MULTIPOLYGON"</span><span class="op">)</span>

<span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_occurrences.html">ala_occurrences</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="va">id</span>, locations <span class="op">=</span> <span class="fu"><a href="../reference/select_locations.html">select_locations</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">simple_shp</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="environmental-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#environmental-layers" class="anchor"></a>Environmental layers</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get all layers relating to precipitation</span>
<span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_layers.html">find_layers</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">layers</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"precipitation"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">layers</span><span class="op">$</span><span class="va">description</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">$</span><span class="va">name</span></code></pre></div>
<pre><code>##  [1] "2030A1BMk35M: Precipitation - driest month" "WorldClim: Precipitation - coldest quarter"
##  [3] "WorldClim: Precipitation - warmest quarter" "WorldClim: Precipitation - driest quarter" 
##  [5] "WorldClim: Precipitation - wettest quarter" "WorldClim: Precipitation - seasonality"    
##  [7] "WorldClim: Precipitation - driest month"    "WorldClim: Precipitation - wettest month"  
##  [9] "WorldClim: Precipitation - annual"          "Precipitation - wettest month"             
## [11] "Precipitation - driest month"               "Precipitation - coldest quarter (Bio19)"   
## [13] "Precipitation - warmest quarter (Bio18)"    "Precipitation - driest quarter  (Bio17)"   
## [15] "Precipitation - wettest quarter (Bio16)"    "Precipitation - seasonality (Bio15)"       
## [17] "Precipitation - annual (Bio12)"             "Precipitation - driest period (Bio14)"     
## [19] "Precipitation - wettest period (Bio13)"</code></pre>
</div>
<div id="fields-and-categories" class="section level3">
<h3 class="hasAnchor">
<a href="#fields-and-categories" class="anchor"></a>Fields and categories</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View all available fields</span>
<span class="fu"><a href="../reference/find_fields.html">find_fields</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># View values for a given field</span>
<span class="fu"><a href="../reference/find_field_values.html">find_field_values</a></span><span class="op">(</span><span class="st">'basisOfRecord'</span><span class="op">)</span></code></pre></div>
</div>
<div id="data-quality-profile" class="section level3">
<h3 class="hasAnchor">
<a href="#data-quality-profile" class="anchor"></a>Data quality profile</h3>
<p>By default, the data quality profile is set to the ALA general.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># List available data quality profiles</span>
<span class="fu"><a href="../reference/find_profiles.html">find_profiles</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##   id                                  name shortName
## 1  2                           ALA General       ALA
## 2 35 Species Distribution Modelling (CSDM)      CSDM
## 3 44            Data licensed for all uses re-usable
##                                                                                                                            description
## 1 The default ALA profile filters out records based on the filter groups outlined below.  This is a moderately restricted set of data.
## 2                                                            Base filters for the Collaborative Species Distribution Modelling program
## 3         Data licensed for re-use, including commercial uses. This profile only filters on license, no "quality" filters are applied.</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># List filters for a profile</span>
<span class="fu"><a href="../reference/find_profile_attributes.html">find_profile_attributes</a></span><span class="op">(</span><span class="st">"CSDM"</span><span class="op">)</span></code></pre></div>
<pre><code>##                                                                description                        filter
## 1:                   Include only records where Spatial validity is "true"      geospatial_kosher:"true"
## 2:                                     Exclude potential duplicate records    -duplicate_record:[* TO *]
## 3: Exclude all records that are an outlier against any environmental layer -outlier_layer_count:[* TO *]
## 4:                         Include only records where Year is 1970 to 2099              year:[1970 TO *]</code></pre>
</div>
</div>
<div id="summary-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-statistics" class="anchor"></a>Summary statistics</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Total number of records in the ALA (with no data quality filters)</span>
<span class="fu"><a href="../reference/ala_counts.html">ala_counts</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 94631073</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Total number of records, broken down by kindgom</span>
<span class="fu"><a href="../reference/ala_counts.html">ala_counts</a></span><span class="op">(</span>group_by <span class="op">=</span> <span class="st">"kingdom"</span><span class="op">)</span></code></pre></div>
<pre><code>##         name    count
## 1   Animalia 69454843
## 2    Plantae 20906008
## 3      Fungi  1982832
## 4  Chromista  1037573
## 5   Protista    64612
## 6   Bacteria    58950
## 7   Protozoa    21018
## 8    Archaea     1102
## 9  Eukaryota      735
## 10     Virus      294</code></pre>
</div>
<div id="media-downloads" class="section level2">
<h2 class="hasAnchor">
<a href="#media-downloads" class="anchor"></a>Media downloads</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Search for occurrences with images</span>
<span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_filters.html">select_filters</a></span><span class="op">(</span>multimedia <span class="op">=</span> <span class="st">"Image"</span>,
                          basis_of_record <span class="op">=</span> <span class="st">"HumanObservation"</span><span class="op">)</span>
<span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_occurrences.html">ala_occurrences</a></span><span class="op">(</span><span class="va">quoll</span><span class="op">$</span><span class="va">taxon_concept_id</span>,
                       filters <span class="op">=</span> <span class="va">filters</span><span class="op">)</span>
<span class="va">images</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ala_media.html">ala_media</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">occ</span><span class="op">$</span><span class="va">recordID</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, download_dir <span class="op">=</span> <span class="st">'data/'</span>,
                    identifier_type <span class="op">=</span> <span class="st">"occurrence"</span><span class="op">)</span>

<span class="co"># filter by licence type</span>
<span class="va">images</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">recognisedLicence</span> <span class="op">==</span> <span class="st">"CC BY-NC 4.0"</span><span class="op">)</span></code></pre></div>
</div>
<div id="config" class="section level2">
<h2 class="hasAnchor">
<a href="#config" class="anchor"></a>Config</h2>
<p>Various aspects of the galah package can be customized. To preserve configuration for future sessions, set <code>preserve = TRUE</code>. This will write the config to your <code>.Renviron</code> file.</p>
<div id="email" class="section level3">
<h3 class="hasAnchor">
<a href="#email" class="anchor"></a>Email</h3>
<p>To download occurrence records, you will need to provide an email address registered with the ALA. You can create an account <a href="https://auth.ala.org.au/userdetails/registration/createAccount">here</a></p>
</div>
<div id="caching" class="section level3">
<h3 class="hasAnchor">
<a href="#caching" class="anchor"></a>Caching</h3>
<p><code>galah</code> can cache most results to local files. This means that if the same code is run multiple times, the second and subsequent iterations will be faster. This will also reduce load on the ALA servers.</p>
<p>By default, this caching is session-based, meaning that the local files are stored in a temporary directory that is automatically deleted when the R session is ended. This behaviour can be altered so that caching is permanent, by setting the caching directory to a non-temporary location. For example, under Windows, use something like:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ala_config.html">ala_config</a></span><span class="op">(</span>cache_directory<span class="op">=</span><span class="st">"c:/mydata/ala_cache"</span><span class="op">)</span></code></pre></div>
<p>or for Linux:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ala_config.html">ala_config</a></span><span class="op">(</span>cache_directory<span class="op">=</span><span class="st">"~/mydata/ala_cache"</span><span class="op">)</span></code></pre></div>
<p>Note that this directory must exist (you need to create it yourself).</p>
<p>All results will be stored in that cache directory and will be used from one session to the next.</p>
<p>Caching can also be turned off entirely by:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ala_config.html">ala_config</a></span><span class="op">(</span>caching<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="debugging" class="section level3">
<h3 class="hasAnchor">
<a href="#debugging" class="anchor"></a>Debugging</h3>
<p>If things aren’t working as expected, more detail (particularly about web requests and caching behaviour) can be obtained by setting the <code>verbose</code> configuration option:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ala_config.html">ala_config</a></span><span class="op">(</span>verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="setting-the-download-reason" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-the-download-reason" class="anchor"></a>Setting the download reason</h3>
<p>ALA requires that you provide a reason when downloading occurrence data (via the galah <code><a href="../reference/ala_occurrences.html">ala_occurrences()</a></code> function). The reason is set as “scientific research” by default, but you can change this using <code>ala_config</code>. See <code>ala_reasons()</code> for valid download reasons.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ala_config.html">ala_config</a></span><span class="op">(</span>download_reason_id<span class="op">=</span><span class="va">your_reason_id</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matilda Stevenson, Martin Westgate, Peggy Newman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
